import{l as q,a as O,d as T,u as W}from"./setting-9495429f.js";import{h as j}from"./moment-fbc5633a.js";import{d as G,a as m,r as J,q as P,b as n,s as Q,o as v,c as V,e as t,w as l,f as _,v as R,l as x,g as h,F as X,k as Z,E as r,p as ee,i as te,_ as le}from"./index-94e23d1f.js";import"./index-1d9b39de.js";const oe=p=>(ee("data-v-c3fd483f"),p=p(),te(),p),ae={class:"content"},ne=oe(()=>h("span",null,"系统配置",-1)),se={class:"dialog-footer"},re=G({__name:"Index",setup(p){const f=m(!1),b=m([]),g=(s,e)=>{const i=s[e.property];return i===void 0?"":j(i).utcOffset(8).format("YYYY-MM-DD HH:mm")},w=m([]),d=m(!1),C="100px",o=J({key:"",value:""}),y=async()=>{let s=(await q()).data;s.errorCode===0?(f.value=!1,b.value=s.data.lists):(f.value=!1,r.error(s.msg));let e=(await O()).data;e.errorCode===0?w.value=e.data:r.error(e.msg)},D=(s,e)=>{d.value=!0,o.key=e.Key,o.value=e.Value},I=async s=>{if(!s.Key)r.error("未获取到的删除的内容");else{o.key=s.Key;const e=await T(o);e.data.errorCode===0?(r.success("删除成功"),await y()):r.error(e.data.msg)}},$=async()=>{if(console.log(o),!o.key)r.error("未获取到的变更配置项");else if(!o.value)r.error("未获取到的变更配置值");else{const s=await W(o);s.data.errorCode===0?(r.success("变更成功"),o.key="",o.value="",await y()):r.error(s.data.msg),d.value=!1}},B=()=>{d.value=!1,o.key="",o.value=""};return P(async()=>{f.value=!0,await y()}),(s,e)=>{const i=n("el-col"),u=n("el-button"),E=n("el-row"),F=n("el-divider"),c=n("el-table-column"),K=n("el-popconfirm"),M=n("el-table"),N=n("el-card"),U=n("el-option"),Y=n("el-select"),k=n("el-form-item"),z=n("el-input"),S=n("el-form"),A=n("el-dialog"),H=Q("loading");return v(),V("div",ae,[t(N,{shadow:"never"},{default:l(()=>[t(E,null,{default:l(()=>[t(i,{span:2},{default:l(()=>[ne]),_:1}),t(i,{offset:18,span:3,style:{"min-width":"120px"}},{default:l(()=>[t(u,{size:"small",type:"primary",onClick:e[0]||(e[0]=a=>d.value=!0)},{default:l(()=>[_("添加集群")]),_:1})]),_:1})]),_:1}),t(F),R((v(),x(M,{data:b.value,stripe:"",style:{width:"100%"}},{default:l(()=>[t(c,{prop:"Name",label:"名称",width:"180"}),t(c,{prop:"Key",label:"key",width:"180"}),t(c,{prop:"Value",label:"value"}),t(c,{prop:"CreatedAt",formatter:g,label:"创建时间"}),t(c,{prop:"UpdatedAt",formatter:g,label:"修改时间"}),t(c,{label:"操作"},{default:l(a=>[t(u,{size:"small",onClick:L=>D(a.$index,a.row)},{default:l(()=>[_("修改")]),_:2},1032,["onClick"]),t(K,{title:"确定要删除吗？","confirm-button-text":"确认","cancel-button-text":"取消","confirm-button-type":"danger","cancel-button-type":"primary",onConfirm:L=>I(a.row)},{reference:l(()=>[t(u,{size:"small",type:"danger"},{default:l(()=>[_("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[H,f.value]])]),_:1}),t(A,{modelValue:d.value,"onUpdate:modelValue":e[5]||(e[5]=a=>d.value=a),title:"配置变更",width:"30%","align-center":""},{footer:l(()=>[h("span",se,[t(u,{onClick:e[3]||(e[3]=a=>B())},{default:l(()=>[_("取消")]),_:1}),t(u,{type:"primary",onClick:e[4]||(e[4]=a=>$())},{default:l(()=>[_("确定")]),_:1})])]),default:l(()=>[t(S,{model:o},{default:l(()=>[t(k,{label:"配置项","label-width":C},{default:l(()=>[t(Y,{modelValue:o.key,"onUpdate:modelValue":e[1]||(e[1]=a=>o.key=a),placeholder:"请选择需要变更的配置"},{default:l(()=>[(v(!0),V(X,null,Z(w.value,a=>(v(),x(U,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(k,{label:"配置值","label-width":C},{default:l(()=>[t(z,{modelValue:o.value,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value=a),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const _e=le(re,[["__scopeId","data-v-c3fd483f"]]);export{_e as default};
