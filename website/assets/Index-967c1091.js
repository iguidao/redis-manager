import{a as re,c as de,l as ie}from"./codis-7a3bd4ff.js";import{l as pe,a as ve}from"./cloud-3a6d1fb9.js";import{c as me,l as ce}from"./cluster-7426750c.js";import{a as ye}from"./index-04cccabd.js";import{d as Q,a as r,r as N,q as _e,b as v,s as fe,o,c as d,g as ke,e as u,w as t,F as f,k,l as s,n as R,f as H,v as ge,E as g,_ as W}from"./index-056ef9e9.js";const Ve=q=>ye.post("/cli/v1/opkey",q),be={class:"content"},Ce={key:2},we={key:0},xe={key:1},$e=Q({__name:"Cli",props:{opkey:{type:String,default:String,required:!0}},setup(q){const m=q,x=r(!1),n=r(""),c=[{value:"codis",label:"自建codis集群"},{value:"cluster",label:"自建cluster集群"},{value:"aliredis",label:"阿里redis集群"},{value:"txredis",label:"腾讯redis集群"}],V=r(""),b=r(""),E=r([]),F=r([]),G=r([]),$=N({curl:"",cname:"",cluster_name:""}),K=r(""),B=r(""),J=r([]),T=r([]),U=N({cloud:"",region:""}),M=r(""),D=r(""),j=r([]),L=r([]),O=N({cluster_id:""}),S=r(""),i=r(""),p=N({cache_type:"",cache_op:"",cluster_name:"",key_name:"",codis_url:"",group_name:"",region:"",instance_id:"",cluster_id:"",node_id:""}),P=r(),X=N(P),z=async()=>{x.value=!0,p.cache_type=n.value,p.cache_op=m.opkey,p.cluster_name=b.value,p.key_name=i.value,p.codis_url=V.value,p.group_name=S.value,p.region=K.value,p.instance_id=B.value,p.cluster_id=String(M.value),p.node_id=D.value;let a=(await Ve(p)).data;a.errorCode===0?(x.value=!1,P.value=a.data):(x.value=!1,g.error(a.msg))},Y=async()=>{b.value="",$.curl=V.value;let a=(await re($)).data;a.errorCode===0?F.value=a.data:g.error(a.msg)},Z=async()=>{$.curl=V.value,$.cluster_name=b.value;let a=(await de($)).data;a.errorCode===0?G.value=a.data:g.error(a.msg)},h=async()=>{U.cloud=n.value,U.region=K.value;let a=(await pe(U)).data;a.errorCode===0?T.value=a.data.redis_list:g.error(a.msg)},ee=async()=>{O.cluster_id=M.value;let a=(await me(O)).data;a.errorCode===0?L.value=a.data:g.error(a.msg)},le=async()=>{if(n.value=="codis"){let a=(await ie()).data;a.errorCode===0?E.value=a.data.lists:g.error(a.msg)}else if(n.value=="txredis"){U.cloud=n.value;let a=(await ve(U)).data;a.errorCode===0?J.value=a.data.region_list:g.error(a.msg)}else if(n.value=="cluster"){let a=(await ce()).data;a.errorCode===0?j.value=a.data:g.error(a.msg)}},ae=async()=>{};return _e(async()=>{await ae()}),(a,l)=>{const y=v("el-option"),_=v("el-select"),I=v("el-col"),C=v("el-input"),A=v("el-button"),oe=v("el-popconfirm"),te=v("el-row"),ue=v("el-divider"),se=v("JsonViewer"),ne=fe("loading");return o(),d("div",be,[ke("div",null,[u(te,{gutter:1},{default:t(()=>[u(I,{span:2},{default:t(()=>[u(_,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=e=>n.value=e),placeholder:"Redis集群",onChange:l[1]||(l[1]=e=>le())},{default:t(()=>[(o(),d(f,null,k(c,e=>u(y,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),u(I,{span:2},{default:t(()=>[n.value==="codis"?(o(),s(_,{key:0,modelValue:V.value,"onUpdate:modelValue":l[2]||(l[2]=e=>V.value=e),placeholder:"选择codis平台",onChange:l[3]||(l[3]=e=>Y())},{default:t(()=>[(o(!0),d(f,null,k(E.value,e=>(o(),s(y,{key:e.Cname,label:e.Cname,value:e.Curl},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):n.value==="txredis"?(o(),s(_,{key:1,modelValue:K.value,"onUpdate:modelValue":l[4]||(l[4]=e=>K.value=e),placeholder:"选择腾讯Region",onChange:l[5]||(l[5]=e=>h())},{default:t(()=>[(o(!0),d(f,null,k(J.value,e=>(o(),s(y,{key:e.RegionName,label:e.RegionName,value:e.Region},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):n.value==="cluster"?(o(),s(_,{key:2,modelValue:M.value,"onUpdate:modelValue":l[6]||(l[6]=e=>M.value=e),placeholder:"选择集群",onChange:l[7]||(l[7]=e=>ee())},{default:t(()=>[(o(!0),d(f,null,k(j.value,e=>(o(),s(y,{key:e.Name,label:e.Name,value:e.ID},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):R("",!0)]),_:1}),u(I,{span:2},{default:t(()=>[n.value==="codis"?(o(),s(_,{key:0,modelValue:b.value,"onUpdate:modelValue":l[8]||(l[8]=e=>b.value=e),placeholder:"选择集群",onChange:l[9]||(l[9]=e=>Z())},{default:t(()=>[(o(!0),d(f,null,k(F.value,e=>(o(),s(y,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):n.value==="txredis"?(o(),s(_,{key:1,modelValue:B.value,"onUpdate:modelValue":l[10]||(l[10]=e=>B.value=e),placeholder:"选择集群"},{default:t(()=>[(o(!0),d(f,null,k(T.value,e=>(o(),s(y,{key:e.InstanceName,label:e.InstanceName,value:e.InstanceId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):R("",!0),n.value==="cluster"?(o(),d("div",Ce,[a.$props.opkey==="query"?(o(),s(C,{key:0,modelValue:i.value,"onUpdate:modelValue":l[11]||(l[11]=e=>i.value=e),class:"w-10 m-2",placeholder:"请输入key名称"},null,8,["modelValue"])):a.$props.opkey==="del"?(o(),s(C,{key:1,modelValue:i.value,"onUpdate:modelValue":l[12]||(l[12]=e=>i.value=e),class:"w-10 m-2",placeholder:"要删除的key名称"},null,8,["modelValue"])):(o(),s(_,{key:2,modelValue:D.value,"onUpdate:modelValue":l[13]||(l[13]=e=>D.value=e),placeholder:"选择Master"},{default:t(()=>[(o(!0),d(f,null,k(L.value,e=>(o(),s(y,{key:e.Ip+":"+e.Port,label:e.Flags+": "+e.SlotRange,value:e.NodeId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))])):R("",!0)]),_:1}),u(I,{span:5},{default:t(()=>[n.value==="codis"?(o(),d("div",we,[a.$props.opkey==="query"?(o(),s(C,{key:0,modelValue:i.value,"onUpdate:modelValue":l[14]||(l[14]=e=>i.value=e),class:"w-10 m-2",placeholder:"请输入key名称"},null,8,["modelValue"])):a.$props.opkey==="del"?(o(),s(C,{key:1,modelValue:i.value,"onUpdate:modelValue":l[15]||(l[15]=e=>i.value=e),class:"w-10 m-2",placeholder:"要删除的key名称"},null,8,["modelValue"])):(o(),s(_,{key:2,modelValue:S.value,"onUpdate:modelValue":l[16]||(l[16]=e=>S.value=e),placeholder:"选择Group"},{default:t(()=>[(o(!0),d(f,null,k(G.value,e=>(o(),s(y,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))])):n.value==="txredis"?(o(),d("div",xe,[a.$props.opkey==="query"?(o(),s(C,{key:0,modelValue:i.value,"onUpdate:modelValue":l[17]||(l[17]=e=>i.value=e),class:"w-10 m-2",placeholder:"请输入key名称"},null,8,["modelValue"])):a.$props.opkey==="del"?(o(),s(C,{key:1,modelValue:i.value,"onUpdate:modelValue":l[18]||(l[18]=e=>i.value=e),class:"w-10 m-2",placeholder:"要删除的key名称"},null,8,["modelValue"])):R("",!0)])):R("",!0)]),_:1}),u(I,{offset:8,span:4},{default:t(()=>[a.$props.opkey==="del"?(o(),s(oe,{key:0,title:"确定要删除吗？","confirm-button-text":"确认","cancel-button-text":"取消","confirm-button-type":"danger","cancel-button-type":"primary",onConfirm:l[19]||(l[19]=e=>z())},{reference:t(()=>[u(A,{type:"danger"},{default:t(()=>[H("删除")]),_:1})]),_:1})):(o(),s(A,{key:1,type:"primary",onClick:l[20]||(l[20]=e=>z())},{default:t(()=>[H("查询")]),_:1}))]),_:1})]),_:1})]),u(ue),ge((o(),d("div",null,[u(se,{value:X,"expand-depth":"2",copyable:"",boxed:"",sort:""},null,8,["value"])])),[[ne,x.value]])])}}});const w=W($e,[["__scopeId","data-v-1b6ebbad"]]),Ue={class:"content"},Ie=Q({__name:"Index",setup(q){const m=r("");return(x,n)=>{const c=v("el-tab-pane"),V=v("el-tabs");return o(),d("div",Ue,[u(V,{type:"border-card",modelValue:m.value,"onUpdate:modelValue":n[0]||(n[0]=b=>m.value=b)},{default:t(()=>[u(c,{name:"query",label:"查询Key"},{default:t(()=>[u(w,{opkey:m.value},null,8,["opkey"])]),_:1}),u(c,{name:"slow",label:"查询慢查询"},{default:t(()=>[u(w,{opkey:m.value},null,8,["opkey"])]),_:1}),u(c,{name:"big",label:"查询大Key"},{default:t(()=>[u(w,{opkey:m.value},null,8,["opkey"])]),_:1}),u(c,{name:"hot",label:"查询热Key"},{default:t(()=>[u(w,{opkey:m.value},null,8,["opkey"])]),_:1}),u(c,{name:"all",label:"查询1万Key"},{default:t(()=>[u(w,{opkey:m.value},null,8,["opkey"])]),_:1}),u(c,{name:"del",label:"删除Key"},{default:t(()=>[u(w,{opkey:m.value},null,8,["opkey"])]),_:1})]),_:1},8,["modelValue"])])}}});const Be=W(Ie,[["__scopeId","data-v-5dc9fb7f"]]);export{Be as default};
